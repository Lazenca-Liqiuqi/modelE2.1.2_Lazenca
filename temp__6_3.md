# Producing Diagnostics / 生成诊断

## 3) HOW-TO produce daily/monthly or seasonal diagnostics / 如何产生日/月或季节性诊断 {#part2_3}

**Controlling the frequency of output of the ACC files is done using the NAMELIST parameter NMONAV. This sets the number of months over which the diagnostics is accumulated. If it is set to 3, seasonal acc files are produced. If set to 12, you will get annual means. Higher numbers could be chosen, but are probably not very useful.**
控制ACC文件的输出频率是使用NAMELIST参数NMONAV完成的。这设置了诊断累积的月数。如果设置为3，则产生季节性acc文件。如果设置为12，您将获得年度平均值。可以选择更高的数字，但可能不是很有用。

**Producing more frequent diagnostics is controlled by the SUBDAILY module. The frequency of saving is controlled by the variable Nsubdd which is the number of internal timesteps between each snapshot (i.e. Nsubdd=1 implies diags every timestep, =24 daily (if dtsrc=3600), =48 is daily for dtsrc=1800). The variables saved are controlled by the strings SUBDD, SUBDD1, which are space seperated lists of names for the required diagnostics. These are currently limited to instantaneous values (with some exceptions as noted below) of some standard fields (SLP, PS, SAT, PREC, QS, LCLD, MCLD, HCLD, PTRO QLAT, QSEN, SWD, SWU, LWD, LWU, LWT, STX, STY, ICEF, SNOWD, TCLD, SST, SIT, US, VS, TMIN, TMAX), the geopotential height, relative and specific humidity and temperature on any (or all) of the following fixed pressure levels (if available): 1000, 850, 700, 500, 300, 100, 30 , 10, 3.4, 0.7, .16, .07, .03, and velocities on any model level. The fixed pressure level diags are set using Z850, R700 and T100, for instance, to request the 850 mb geopotential height, 700 mb relative humidity and 100 mb temperatures, respectively. Requests for ZALL or TALL, will produce individual files of all available levels. The velocities are set using U1, U5, U12, for instance, to get the 1st, 5th and 12th layer U velocities, respectively. If "ALL" levels are requested for a velocity, only one file per variable will be output, containing all requested levels. To limit the number of output levels, set the LmaxSUBDD parameter in the rundeck, and only levels L=1,LmaxSUBDD will be output.**
产生更频繁的诊断由SUBDAILY模块控制。保存频率由变量Nsubdd控制，这是每个快照之间的内部时间步数（即Nsubdd=1表示每个时间步都有诊断，=24表示每日（如果dtsrc=3600），=48表示dtsrc=1800时的每日）。保存的变量由字符串SUBDD, SUBDD1控制，这些是所需诊断名称的空格分隔列表。目前这些仅限于某些标准字段的瞬时值（如下面注意到的一些例外）（SLP, PS, SAT, PREC, QS, LCLD, MCLD, HCLD, PTRO QLAT, QSEN, SWD, SWU, LWD, LWU, LWT, STX, STY, ICEF, SNOWD, TCLD, SST, SIT, US, VS, TMIN, TMAX），在以下固定气压层（如果可用）上的位势高度、相对湿度和比湿度及温度：1000, 850, 700, 500, 300, 100, 30, 10, 3.4, 0.7, .16, .07, .03，以及任何模型层的速度。固定气压层诊断使用Z850, R700和T100设置，例如，分别请求850 mb位势高度、700 mb相对湿度和100 mb温度。对ZALL或TALL的请求将产生所有可用层的单独文件。速度使用U1, U5, U12设置，例如，分别获取第1、第5和第12层的U速度。如果为速度请求"ALL"层，每个变量只会输出一个文件，包含所有请求的层。为了限制输出层的数量，在rundeck（运行配置）中设置LmaxSUBDD参数，只有L=1,LmaxSUBDD的层将被输出。

**More options can be added as cases in subroutine get_subdd in DIAG.f if required. For example, including the following string in the rundeck (i.e. SUBDD="SLP SAT Z500 R850 U5 V5" will produce diags of the sea level pressure, surface air temperature, 500mb geopotential heights, 850 mb level relative humidity and the 5th layer U, and V fields. Each timeseries will be output one month at a time in files named SLPmmmyyyy and SATmmmyyyy (for example) for each month and year. Restarts will find the appropriate file and continue to append records as would be expected.**
如果需要，可以在DIAG.f的子程序get_subdd中添加更多选项作为情况。例如，在rundeck（运行配置）中包含以下字符串（即SUBDD="SLP SAT Z500 R850 U5 V5"将产生海平面气压、表面气温、500mb位势高度、850 mb层相对湿度和第5层U和V场的诊断。每个时间序列将在每个月输出一次，在名为SLPmmmyyyy和SATmmmyyyy（例如）的文件中，对应每个月和年份。重启将找到相应的文件并继续追加记录，正如预期的那样。

**There are three minor special cases to the procedure outlined above. i) PREC will give the accumulated precipitation over the Nsubdd period. ii) TMIN and TMAX are the minimum and maximum daily composite surface air temperatures at each grid point, and therefore can only be output once a day. Note that Nsubdd must divide into the daily number of internal timesteps for this to work properly. i.e. if dtsrc=1800s, there are 48 internal time steps per day. If Nsubdd=6 (denoting 3 hourly output), TMIN and TMAX will be output correctly at midnight UTC once a day. However, if Nsubdd=5 (2.5 hourly output), TMIN and TMAX will only be output every five days as the output hour coincides with midnight UTC.**
上述过程有三个小的特殊情况。i) PREC将给出Nsubdd期间的累积降水量。ii) TMIN和TMAX是每个网格点日合成表面气温的最小值和最大值，因此只能每天输出一次。注意Nsubdd必须能整除每天的内部时间步数才能正常工作。即如果dtsrc=1800s，每天有48个内部时间步。如果Nsubdd=6（表示3小时输出），TMIN和TMAX将在UTC午夜每天正确输出一次。但是，如果Nsubdd=5（2.5小时输出），TMIN和TMAX将每五天才输出一次，因为输出小时与UTC午夜重合。

**You can easily keep track of the running average of all the printout diagnostics using the NIPRNT switch in the parameter database. By setting this to a positive number, the diagnostics will be printed out that number of hours. (i.e. setting NIPRNT=10, will print out the running average of the accumulated diagnostics at the end of each of the next ten hours).**
您可以使用参数数据库中的NIPRNT开关轻松跟踪所有打印诊断的运行平均值。通过将其设置为正数n，诊断将每小时输出一次，持续n小时。（即设置NIPRNT=10，将在接下来十个小时的每个小时结束时打印累积诊断的运行平均值）。
